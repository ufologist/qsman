!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(e=e||self).QsMan=n()}(this,function(){"use strict";function r(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e){var n=e;return(n||null!=n)&&("number"!=typeof n||isFinite(n))||(n=""),String(n)}function f(e){var n=e.indexOf("#");return e.substring(0,-1!==n?n:e.length)}function y(e){var t=[];if(!e)return t;if("string"==typeof e)for(var n=e.split("&"),r=0,i=n.length;r<i;r++){var o=n[r],u=o.indexOf("="),s="",a=void 0;-1!==u?(s=o.substring(0,u),a=o.substring(u+1,o.length)):s=o;try{s=decodeURIComponent(s)}catch(e){console.warn("decodeURIComponent key error, remain key",s,e)}if(void 0!==a)try{a=decodeURIComponent(a)}catch(e){console.warn("decodeURIComponent value error, remain value",a,e)}else a="";t.push({key:s,value:a})}else for(s in e)if(Object.prototype.hasOwnProperty.call(e,s)){var c=s;try{c=decodeURIComponent(c)}catch(e){console.warn("decodeURIComponent key error, remain key",c,e)}a=e[s];if("[object Array]"===Object.prototype.toString.call(a))a.forEach(function(e){var n=l(e);try{n=decodeURIComponent(n)}catch(e){console.warn("decodeURIComponent value error, remain value",n,e)}t.push({key:c,value:n})});else{a=l(a);try{a=decodeURIComponent(a)}catch(e){console.warn("decodeURIComponent value error, remain value",a,e)}t.push({key:c,value:a})}}return t}return function(){function i(e){var n,t,r;!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,i),this._url=e||"",this._queryStringKvs=y((n=this._url,t=f(n),-1!==(r=t.indexOf("?"))?t.substring(r+1):""))}var e,n,t;return e=i,(n=[{key:"append",value:function(e){var n=y(e);return this._queryStringKvs=this._queryStringKvs.concat(n),this}},{key:"get",value:function(e){return this.getAll(e)[0]}},{key:"getAll",value:function(n){return this._queryStringKvs.filter(function(e){return e.key===n}).map(function(e){return e.value})}},{key:"set",value:function(n,e){var t={};t[n]=e;var r=y(t),i=this._queryStringKvs.filter(function(e){return e.key===n});if(0<i.length){var o=this._queryStringKvs.indexOf(i[0]);this.delete(n);for(var u=this._queryStringKvs.slice(0,o),s=this._queryStringKvs.slice(o+1),a=0,c=r.length;a<c;a++)u.push(r[a]);this._queryStringKvs=u.concat(s)}else this.append(t);return this}},{key:"has",value:function(n){return 0<this._queryStringKvs.filter(function(e){return e.key===n}).length}},{key:"delete",value:function(n){var t=this._queryStringKvs;return t.filter(function(e){return e.key===n}).forEach(function(e){var n=t.indexOf(e);t.splice(n,1)}),this}},{key:"keys",value:function(){return this._queryStringKvs.reduce(function(e,n){return-1===e.indexOf(n.key)&&e.push(n.key),e},[])}},{key:"sort",value:function(){return this._queryStringKvs.sort(function(e,n){return e.key>n.key?1:e.key<n.key?-1:0}),this}},{key:"toString",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],n="",t=this._queryStringKvs;t=t.filter(function(e){return""!==e.key}),e||(t=t.filter(function(e){return""!==e.value}));var r,i,o,u=t.map(function(e){return encodeURIComponent(e.key)+"="+encodeURIComponent(e.value)}).join("&");r=this._url,i=f(r),o=i.indexOf("?"),n=i.substring(0,-1!=o?o:i.length),u&&(n=n?n+"?"+u:u);var s,a,c=(s=this._url,-1!==(a=s.indexOf("#"))?s.substring(a+1):"");return c&&(n=n+"#"+c),n}},{key:"replace",value:function(e){for(var n=y(e),t=0,r=n.length;t<r;t++)this.delete(n[t].key);return this.append(e),this}},{key:"getObject",value:function(){return this._queryStringKvs.reduce(function(e,n){var t=n.key,r=n.value,i=e[t];return void 0===i?e[t]=r:"[object Array]"===Object.prototype.toString.apply(i)?i.push(r):e[t]=[i,r],e},{})}}])&&r(e.prototype,n),t&&r(e,t),i}()});
